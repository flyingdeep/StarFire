<!doctype html>
<html>
<head>

    <title>找摊位</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <style type="text/css">
        body, html,#mapContainer {width: 100%;height: 100%;overflow: hidden;margin:0;}
    </style>

    <link rel="stylesheet" type="text/css" href="framework/appframework-master/build/icons.css" />
    <link rel="stylesheet" type="text/css" href="framework/appframework-master/build/af.ui.css" />
    <link rel="stylesheet" type="text/css" href="css/customize.css" />

    <script type="text/javascript" src="./js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="./js/fastclick.js"></script>


    <script type="text/javascript" src="./js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?type=quick&ak=NpZPLFzDKjPWEenu8D2yf4vS&v=1.0"></script>

    <script type="text/javascript" src="./js/class/remoteProxy.js"></script>
    <script type="text/javascript" src="./js/baidu/maphelper.js"></script>
    <script type="text/javascript" src="./js/baidu/initial.js"></script>


    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.shim.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.ui.js"></script>

    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.desktopBrowsers.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.actionsheet.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.animation.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.touchEvents.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.popup.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.drawer.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.toast.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.animateheader.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.splashscreen.js"></script>
    <script type="text/javascript" charset="utf-8" src="framework/appframework-master/src/af.swipereveal.js"></script>



    <script type="text/javascript">
        $.afui.useOSThemes=false;
        $.afui.loadDefaultHash=true;
        $.afui.autoLaunch=false;
        $(document).ready(function(){
            $.afui.launch();
        });

    </script>

</head>
<body>
<!----------------------   Main Map View --------------------->
<div class="view" id="mainView">
    <header id="mapHeader">
        <div style="float:left;padding:0"><a href="#" class="icon info green button mini">个人信息</a></div>
        <div style="float:right;padding:0"><a href="#" class="icon right green button mini">摊位列表</a></div>
    </header>
    <div class="pages">

          <div class="panel"  id="mapPanel" data-selected="true">
           <div id="mapContainer"></div>
          </div>
    </div>
</div>


<script type="text/javascript">
    var map = new BMap.Map("mapContainer");
    var gc = new BMap.Geocoder();
    var init_city = "上海";


    var Json_mapcenter; //map center val
    var Json_tap_postion; //finger tap position return Json
    var Json_decode_postion2address; //get address from position
    var current_map_level;



    //map.centerAndZoom(new BMap.Point(CONST_POINT_X, CONST_POINT_Y), CONST_DISPLAY_LEVEL);
    map.centerAndZoom(init_city, CONST_DISPLAY_LEVEL);



    var map_dragend_event = function (){
        Json_mapcenter = getMapCenter();
    };

    var map_click_event = function (e){
        var pt = e.point;
        Json_tap_postion =
        {
            "point_x": pt.lng,
            "point_y":  pt.lat
        };
        alert(Json_tap_postion.point_x + "  " + Json_tap_postion.point_y);
        gc.getLocation(pt, function(rs){
            var addComp = rs.addressComponents;
            Json_decode_postion2address = {
                "province": addComp.province,
                "city": addComp.city,
                "district": addComp.district,
                "street": addComp.street,
                "streetNumber": addComp.streetNumber
            };
        });

    };
    var map_zoomend_event = function (){

        current_map_level = map.getZoom();

    }
    map.addEventListener("dragend", map_dragend_event);
    map.addEventListener("click", map_click_event);
    map.addEventListener("zoomend", map_zoomend_event);
</script>
</body>
</html>